# MQ语言常用命令大全

MQ语言是按键精灵针对旗下移动产品而设计的全新脚本开发语言，语言支持全中文阅读脚本，上手简单，易学易用。

## 数据类型
MQ语言为动态类型，即定义变量时并不指定类型，在给变量赋值时才确定类型，并且类型随时可以通过赋值操作而变化。MQ语言中，数据类型有5种：

数据类型 | 解释
---|---
Null | 不包含任何有效数据
Boolean | 仅包含True和False
Integer	| 32位有符号整数，范围为-2,147,483,648 到 2,147,483,647 之间
Float | 双精度浮点数，负数范围从 -1.79769313486232E308 到-4.94065645841247E-324，正数范围从 4.94065645841247E-324 到1.79769313486232E308
String | 字符串，采用一对双引号包含的内容

## 变量
MQ语言的命名方式如下：
* 变量名不区分大小写，同时关键字（如If、Dim）与子程序的名字也无须区分大小写。
* 变量名、关键字及子程序的命名同时支持中文及英文，除了第一个字母外，后续内容还可以用数字。
* 变量在使用前必须用Dim语句定义，但Dim语句不必指定类型；声明多个变量时，使用逗号分隔变量；例如：Dim Top, Bottom, Left, Right, 上, 下, 左2, 右1。
* 变量的作用域由声明它的位置决定。如果在子程序中声明变量，则只有该子程序中的代码可以访问或更改变量值，此时变量具有局部作用域并被称为局部变量。如果在子程序之外声明变量，则该变量可以被当前脚本的所有子程序所识别，称为全局变量。

## 数据结构
### 数组
数组可以是一维的，也可以是多维的，数组的每个维度的索引都是从0开始的正整数，当定义一维数组时，可以指定数组的初始元素个数，也可以不指定。如：Dim Array(), Dim Array(10)。

上述例子都可以定义一个一维数组。但即使指定了数组的初始元素个数，以后也可以随时增加新的元素（直接访问新的元素即可）。当定义多维数组的时候，则必须指定数组在每个维度的初始元素个数，各个维度的初始元素个数之间用逗号分隔，如：

Dim TwoDemensionArray(2,2)

目前，多维数组暂时不支持增加新的元素，也不支持ReDim语句，待以后再支持。

## 运算符
变量和常量之间采用运算符连接后，称为表达式。MQ语言支持的运算符包括：

运算符 | 含义
---|---
+ | 加法运算
- | 二元运算符：减法；一元运算符：负号
* | 乘法运算
/ | 除法运算
Mod | 整除取余
^ | 取幂
& | 字符串连接
= | 等于（当用于表达式内部时）
<> | 不等于
> | 大于
< | 小于
>= | 大于等于
<= | 小于等于
Not | 逻辑非
And | 逻辑与
Or | 逻辑或

## 基本语句
### 条件语句
#### If 条件判断
**语法格式：**

```
If 条件  Then // 参数1是条件型，任意有效的表达式
执行语句
End If // 无返回值
```

**脚本案例：**

```
例子1：
Dim i=0
If i=0 Then
    TracePrint "条件判断符合被通过!!"
End If
//通过判断表达式的取值，来执行后面的动作或控制

例子2：
Dim i=0
If i=0 Then
    TracePrint "条件判断符合被通过!!"
ElseIf i=1 Then
    TracePrint "否则条件判断符合被通过!!"
Else
    TracePrint "否则!!"
End If
//通过判断表达式的取值，来执行后面的动作或控制
```

#### Select Case 情况选择
**语法格式：**

```
Select Case 变量 // 变量：任意有效变量，检查是否与下面值相等
Case 值1[,值2,...] // 值：任意有效值，不支持判断语句，多个值用逗号“,”隔开表示逻辑运算中的“或”运算
执行语句1
Case Else
执行语句2
End Select
循环体
Wend
```

**脚本案例：**

```
//不支持判断语句 如：Case a>0
Dim 变量=1
Select Case 变量
Case 0, 1 // 可支持判断多个值,中间以逗号隔开
    TracePrint "你输入的数字为：0或者1"  
Case 2
    TracePrint "你输入的数字为：2" 
Case 3
    TracePrint "你输入的数字为：3" 
Case 4
    TracePrint "你输入的数字为：4" 
Case 5
    TracePrint "你输入的数字为：5" 
Case 6
    TracePrint "你输入的数字为：6" 
Case 7
    TracePrint "你输入的数字为：7" 
Case 8
    TracePrint "你输入的数字为：8" 
Case 9
    TracePrint "你输入的数字为：9" 
Case Else
    TracePrint "你输入的数字不正确，请输入（0~9）数字！"
End Select
```

### 循环语句
#### Do 循环
条件循环语句，可以是无限循环，也可以是有限循环。

**脚本案例：**

```
例子1：
//支持Exit Do 命令退出循环
Do 
    TracePrint "我停不下来啦!!快住手"
Loop
//最常见的无限循环（死循环）

例子2：
Dim i=0
Do While i=0
    TracePrint "我停不下来啦!!快住手"
Loop
//当循环条件成立的时候，反复执行循环体

例子3：
Dim i=0
Do Until i=0
    TracePrint "为什么没有循环到我呢？"
Loop
TracePrint "循环结束"
//当循环条件成立的时候，离开循环体

例子4：
Dim i=0
Do Until i=1
    TracePrint "我停不下来啦!!快住手"
Loop
//当循环条件不成立的时候，反复执行循环体

例子5：
Dim i=0
Do 
   TracePrint "ok"
Loop While i <> 0
//条件放后面，前面的循环内容可以执行一次！

例子6：
Dim n=0
Do While true
    TracePrint "我将循环10次停下来!!"
    If n>=10 Then
        //当循环条件成立的时候，离开循环体
        Exit do
    End if
    n=n+1
Loop
TracePrint n & "次"
```

#### For 循环
循环语句，可以循环一定次数，也可以按照变量的起始数值到终止数值循环（如果不指定步长数值，默认步长为1）。

**脚本案例：**

```
例子1：固定循环次数后离开
For 10 '固定循环10次跳出
    TracePrint "循环中……"
Next
TracePrint "离开循环"

例子2：范围循环
Dim i
For i = 0 To 9 '这里没写步长，默认每次循环结束 i 都+1，那么10次后等于9，第11次等于10，大于9，离开循环
    TracePrint "循环中，i=" & i
Next
TracePrint "离开循环，i=" & i

Dim i
For i = 0 To 19 Step 2 '步长为2，每次循环结束 i 都+2，那么10次后等于18，第11次等于20，大于19，离开循环
    TracePrint "循环中，i=" & i
Next
TracePrint "离开循环，i=" & i

Dim i
For i = 9 To 0 Step -1 '步长为-1，每次循环结束 i 都-1，那么10次后等于0，第11次等于-1，小于0，离开循环
    TracePrint "循环中，i=" & i
Next
TracePrint "离开循环，i=" & i

例子3：循环离开
Dim i
i=5
For i=0 To 10
    TracePrint "循环中，i=" & i
    If i=5 Then
        Exit For '离开当前For循环
    End If
Next
```

#### For Each...In遍历循环
对数组中的每个元素重复执行一段语句。

**脚本案例：**

```
Dim Arr
Arr=Array("我","爱","按","键","精","灵","!")
For Each a In Arr 
TracePrint  a    //输出数组的所有元素
Next
```

#### While循环
如果条件表达式成立，则循环执行对应语句。

**脚本案例：**

```
例子1
Dim i=0
While i=0
    TracePrint "我停不下来啦!!快住手"
Wend
//当循环条件成立的时候，反复执行循环体

例子2
Dim i
i = 0
//跳出循环
While i < 10
   i = i + 1
   TracePrint "正在循环中，i=", i
   If i = 5 then
      TracePrint "准备退出循环"
      Exit While
   End If
Wend
TracePrint "循环结束，i=", i
```

## 内置命令
MQ语言中已经包含了下列名称的子程序（也称为内置命令），在脚本中可以随时调用。

名称 | 格式 | 解释
---|---|---
Abs | Abs（数值表达式） | 返回数值的绝对值，绝对值是其无符号的数值大小。例如，Abs(-1) 和 Abs(1) 都返回 1

